<h2 class="page-title">Product Management</h2>

<div class="toolbar">
  <mat-form-field appearance="outline" class="search">
    <mat-label>Search products</mat-label>
    <input matInput (keyup)="applyFilter($event)" />
  </mat-form-field>

  <button
    mat-raised-button
    class="add-btn"
    color="primary"
    (click)="addProduct()">
    Add Product
  </button>
</div>

<table mat-table [dataSource]="dataSource" matSort class="user-table">

  <!-- Product Name -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Product</th>
    <td mat-cell *matCellDef="let p">{{ p.name }}</td>
  </ng-container>

  <!-- Category -->
  <ng-container matColumnDef="category">
    <th mat-header-cell *matHeaderCellDef>Category</th>
    <td mat-cell *matCellDef="let p">{{ p.category }}</td>
  </ng-container>

  <!-- Price -->
  <ng-container matColumnDef="price">
    <th mat-header-cell *matHeaderCellDef>Price</th>
    <td mat-cell *matCellDef="let p">â‚¹{{ p.price }}</td>
  </ng-container>

<!-- Stock -->
<ng-container matColumnDef="stock">
  <th mat-header-cell *matHeaderCellDef class="center stock-header">
    Stock
  </th>
  <td
    mat-cell
    *matCellDef="let p"
    class="center stock-cell"
    [class.low-stock]="p.stock < 5 && p.stock > 0"
    [class.out-stock]="p.stock === 0">
    {{ p.stock }}
  </td>
</ng-container>



<!-- Status -->
<ng-container matColumnDef="status">
  <th mat-header-cell *matHeaderCellDef class="center">Active</th>
  <td mat-cell *matCellDef="let p" class="center">
    <mat-slide-toggle
      class="status-toggle"
      [checked]="p.active"
      [disabled]="!p.categoryIsActive"
      (change)="toggleStatus(p)">
    </mat-slide-toggle>
  </td>
</ng-container>


  <!-- Actions -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef class="center">Actions</th>
    <td mat-cell *matCellDef="let p" class="actions-wrapper">

      <button mat-icon-button class="edit-btn" (click)="editProduct(p)">
        <mat-icon>edit</mat-icon>
      </button>

      <button mat-icon-button class="delete-btn" [disabled]="!p.active"
              (click)="deleteProduct(p)">
        <mat-icon>delete</mat-icon>
      </button>

    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>


<mat-paginator
  [pageSize]="5"
  [pageSizeOptions]="[5, 10, 20]"
  showFirstLastButtons>
</mat-paginator>
